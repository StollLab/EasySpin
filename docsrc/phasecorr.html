<!DOCTYPE html>
<html>
<head>
   <meta charset="utf-8">
   <link rel="icon" href="img/eslogo196.png">
   <link rel="stylesheet" type="text/css" href="style.css">
   <link rel="stylesheet" href="highlight/matlab.css">
   <script src="highlight/highlight.min.js"></script>
   <script src="highlight/do_highlight.js"></script>
   <title>phasecorr</title>
</head>

<body>

<header>
<ul>
<li><img src="img/eslogo42.png">
<li class="header-title">EasySpin
<li><a href="index.html">Documentation</a>
<li><a href="references.html">Publications</a>
<li><a href="http://easyspin.org" target="_blank">Website</a>
<li><a href="http://easyspin.org/academy" target="_blank">Academy</a>
<li><a href="http://easyspin.org/forum" target="_blank">Forum</a>
</ul>
</header>

<section>

<div class="functitle">phasecorr</div>

<p>
Phase correction.
</p>

<!-- =========================================================== -->
<div class="subtitle">Syntax</div>

<pre class="matlab">
Vph = phasecorr(V)
Vph = phasecorr(V,ignoreOffset)
[Vph,ph] = phasecorr(...)
phasecorr(...)
</pre>

<!-- =========================================================== -->
<div class="subtitle">Description</div>

<p>
This function phase corrects the input data <code>V</code> by minimizing the imaginary part by applying a phase angle <code>ph</code> (in radians) via <code>Vph = V.*exp(1i*ph)</code>. There are two types of minimizations: if <code>ignoreOffset</code> is set to <code>false</code>, the second moment of the imaginary part is minimized, and if <code>ignoreOffset</code> is set to <code>true</code>, then the second central moment is minimized.
</p>

<p>
<code>V</code> can be a one- or two-dimensional array. For a two-dimensional array, all data are used in the minimization. Write a loop to individually phase correct rows or columns of a 2D array.
</p>

<p>
<code>Vph</code> has the same size as <code>V</code> and contains the phase-corrected data.
</p>

<p>
<code>ph</code> is applied phase, in radians.
</p>

<p>
If no output is requested, the function plots the original and the phase-corrected data.
</p>

<!-- =========================================================== -->
<div class="subtitle">Examples</div>

<p>
To fit cubic baselines separately along each column, use
</p>

<pre class="matlab">
datac = basecorr(data,1,3);
</pre>

<p>
To fit linear baselines separately along each row, use
</p>

<pre class="matlab">
datac = basecorr(data,2,1);
</pre>

<p>
To fit linear baselines separately along each row, but limit the fit region, use
</p>

<pre class="matlab">
region = x<3 | x>6;  % include region with x<3 and x>6 in the fit
datac = basecorr(data,2,1,region);
</pre>

<p>
To fit a single third-order surface to 2D data, use
</p>

<pre class="matlab">
datac = basecorr(data,[],[3 3]);
</pre>


<!-- =========================================================== -->
<div class="subtitle">Algorithm</div>

<p>
If the offset is taken into account, then an analytical solution is used to determine the phase angle that minimizes the second moment of the imaginary part. If the imaginary offset should be ignored, a numerical optimization is performed.
</p>

<p>
There are always two solutions, differing by 180 degrees. <code>phasecorr</code> returns the solution that is smaller in magnitude.
</p>

<!-- =========================================================== -->
<div class="subtitle">See also</div>

<p>
<a class="esf" href="apowin.html">apowin</a>,
<a class="esf" href="basecorr.html">basecorr</a>,
<a class="esf" href="exponfit.html">exponfit</a>,
<a class="esf" href="datasmooth.html">datasmooth</a>
</p>

<hr>
</section>

<footer></footer>

</body>
</html>
