<!DOCTYPE html>
<html>
<head>
   <meta charset="utf-8">
   <link rel="icon" href="img/eslogo196.png">
   <link rel="stylesheet" type="text/css" href="style.css">
   <link rel="stylesheet" href="highlight/matlab.css">
   <script src="highlight/highlight.min.js"></script>
   <script src="highlight/do_highlight.js"></script>
   <title>propint</title>
</head>

<body>

<header>
<ul>
<li><img src="img/eslogo42.png">
<li class="header-title">EasySpin
<li><a href="index.html">Documentation</a>
<li><a href="references.html">Publications</a>
<li><a href="http://easyspin.org" target="_blank">Website</a>
<li><a href="http://easyspin.org/academy" target="_blank">Academy</a>
<li><a href="http://easyspin.org/forum" target="_blank">Forum</a>
</ul>
</header>

<section>

<div class="functitle">propint</div>

<p>
Compute propagator matrix for quantum dyanmics.
</p>

<!-- ============================================================= -->
<div class="subtitle">Syntax</div>

<pre class="matlab">
U = propint(H0,H1,tlim,freq)
U = propint(H0,H1,tlim,freq,phase)
U = propint(H0,H1,tlim,freq,phase,Opt)
[U,Ustore] = propint(...)

U = propint(Ustore,tlim,freq)
U = propint(Ustore,tlim,freq,phase)
</pre>

<!-- ============================================================= -->
<div class="subtitle">Description</div>

<p>
<code>propint</code> computes a propagator matrix by numerically integrating
</p>

<div class="eqn">
<img src="eqn/propint1.png" alt="[eqn]"><!--MATH
\begin{equation*}
\dot{U}(t) = -\mr{i}2\pi [H_0 + H_1\cos(2\pi\nu t +\phi)] U(t)
\end{equation*}
-->
</div>

<p>
over the interval <code>t=tlim(1)</code> to <code>t=tlim(2)</code>.
</p>

<p>
<code>H0</code> is the static Hamiltonian, <code>H1</code> the time-dependent one.
They should both be in units of MHz.
<code>tlim</code> is a 2-element vector with the start and end time in &mu;s, <code>freq</code> is the irradiation frequency &nu; in MHz.
<code>phase</code> gives the initial phase &phi; in radians (default is 0).
</p>

<p>
<code>Opt</code> is a structure that contains settings for the integration algorithm. <code>Opt.Method</code> specifies the method, possible values are <code>"simple"</code> (which is the default) and <code>"RK4"</code>. <code>"simple"</code> uses the trapezoidal rule, and <code>"RK4"</code> uses the 4th-order Runge-Kutta method.</p> For both methods, <code>Opt.n</code> specifies the number of time steps over one period of the oscillation. The default is 360.
</p>

<p>
The resulting propagator is returned in <code>U</code>. If multiple propagators with different time bounds but identical <code>H0</code> and <code>H1</code>
are wanted, then one should retrieve <code>Ustore</code> from the first call to <code>propint</code>.
</p>

<pre class="matlab">
[Ua,Ustore] = propint(myH0,myH1,tlima,freq);
</pre>

<p>
<code>Ustore</code> contains intermediate integration results which can be reused in the next call. In that case, use the calling form where <code>Ustore</code> is passed as argument instead of <code>H0</code> and <code>H1</code>.
</p>

<pre class="matlab">
Ub = propint(Ustore,tlimb,freq);
</pre>

<p>
The savings in computation time for this second call are enormous.
</p>

<!-- ============================================================= -->
<div class="subtitle">Examples</div>

<p>
A resonant &pi;/2 pulse for a spin-1/2 would be represented by the propagator
</p>

<pre class="matlab">
[Sz,Sy] = sop(1/2,'z','y');  % spin operator matrices
nu0 = 10e3;           % resonance frequency, MHz
tp = 0.010;           % pulse duration, Âµs
theta = pi/2;         % pulse flip angle, rad
nu1 = theta/pi/tp;    % pulse amplitude, MHz
nu_mw = 10e3;         % microwave frequency, MHz
H0 = nu0*Sz;          % static Hamiltonian, MHz
H1 = nu1*Sy;          % microwave Hamiltonian MHz
U = propint(H0,H1,tp,nu_mw)
</pre>

<pre class="mloutput">
U =
   0.7071 + 0.0004i  -0.7071 - 0.0000i
   0.7071 + 0.0000i   0.7071 - 0.0004i
</pre>

<!-- ============================================================= -->
<div class="subtitle">See also</div>

<p>
<a class="esf" href="evolve.html">evolve</a>,
<a class="esf" href="sigeq.html">sigeq</a>
</p>

<hr>
</section>

<footer></footer>

</body>
</html>
