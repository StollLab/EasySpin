<!DOCTYPE html>
<html>
<head>
   <meta charset="utf-8">
   <link rel="icon" href="img/eslogo196.png">
   <link rel="stylesheet" type="text/css" href="style.css">
   <link rel="stylesheet" href="highlight/matlab.css">
   <script src="highlight/highlight.pack.js"></script>
   <script>hljs.initHighlightingOnLoad();</script>
   <title>Spin polarization</title>
</head>

<body>

<header>
<ul>
<li><img src="img/eslogo42.png">
<li class="header-title">EasySpin
<li><a href="index.html">Documentation</a>
<li><a href="references.html">Publications</a>
<li><a href="http://easyspin.org" target="_blank">Website</a>
<li><a href="http://easyspin.org/academy" target="_blank">Academy</a>
<li><a href="http://easyspin.org/forum" target="_blank">Forum</a>
</ul>
</header>

<section>

<h1>Spin-polarized systems and photoselection</h1>

<p>
EasySpin can simulate spin-polarized systems, for example photoexcited triplet states or spin-correlated radical pairs. Depending on the mechanism of spin polarization, the non-equilibrium state of the spin system can be specified in different ways.

<p>
EasySpin can also simulate the effects of photoselection resulting from excitation with plane-polarised laser light often observed in the spectra of photoexcited spin-polarized systems.

<p>
In this user guide, there are the following topics:
</p>

<ul>
<li><a href="#isc">Inter-system crossing (ISC) triplets</a>
<li><a href="#recomb">Recombination triplets</a>
<li><a href="#radpairs">Spin-correlated radical pairs</a>
<li><a href="#photoselection">Photoselection</a>
</ul>

<p>
Although the following sections focus on triplets and radical pairs, the methods can easily be extended to spin-polarized states of spins with higher multiplicity. For related <a href="examplesmain.html">examples</a> see the section on 'EPR simulations for photoexcited systems'.
</p>



<!-- ----------------------------------------------------------------------------- -->
<div class="subtitle"><a name="isc">Inter-system crossing (ISC) triplets</a></div>

<p>
To simulate the EPR spectrum of a triplet generated by inter-system crossing from a singlet state, EasySpin needs information about how ISC populated the zero-field triplet states, usually denoted T<sub>x</sub>, T<sub>y</sub>, T<sub>z</sub>.
You can provide this information in the field <code>Sys.initState</code> by providing energy-ordered populations and specifying <code>'zerofield'</code> as the basis or by providing the populations of the <code>X</code>, <code>Y</code> and <code>Z</code> sublevels and specifying <code>xyz</code> as the basis.

<p>
The first input to <code>Sys.initState</code> should contain a list of populations, one entry for each state, and the second input should contain a keyword defining the corresponding basis.
<br>With the keyword <code>'zerofield'</code>, the populations apply to the <em>zero-field states</em> in increasing energy order. For example, <code>Sys.initState = {[0.1, 1, 0.2],'zerofield'}</code> indicates a population of 0.1 of the lowest zero-field state, a population of 1 of the middle-energy zero-field state, and a population of 0.2 of the highest-energy zero-field state. The populations do not have to add up to 1, but are divided by the sum of the populations internally by EasySpin.
<br>With the keyword <code>'xyz'</code>, the populations apply to the <em>zero-field states</em> in order T<sub>x</sub>, T<sub>y</sub>, and T<sub>z</sub>.

<p>
The energy order of the zero-field triplet states depends on the signs of the zero-field splitting parameters D and E. 
<div class="eqn">
<img src="eqn/spinpolarization1.png" alt="[eqn]"><!--MATH
\begin{equation*}
 \begin{split}
  E_X &= \frac{1}{3}D - E \\
  E_Y &= \frac{1}{3}D + E \\
  E_Z &= -\frac{2}{3}D \\
 \end{split}
\end{equation*}
-->
</div>
By convention, <code>D</code> and <code>E</code> are defined such that <code>-1 &le; 3 E/D &le; 1</code>, so <code>|D| > 3|E|</code> and <code>|Dz| > |Dx| > |Dy|</code>, as described by Poole, C. P. J., Farach, H. A. and Jackson, W. K. in Standardization of convention for zero field splitting parameters, <i>J. Chem. Phys.</i> 61, 2220â€“2221 (<b>1974</b>), DOI: <a href="http://dx.doi.org/10.1063/1.1682294">10.1063/1.1682294</a>.

<p>
Be careful in determining the order of the zero-field triplet states correctly when using <code>Sys.initState</code> with the <code>zerofield</code> basis to simulate spectra from the literature, or when interpreting results from least-squares fitting.

<p>
Here is a full example of a triplet generated by ISC from a singlet
<pre class="matlab">
clear

Triplet.S = 1;
Triplet.D = [500 -100]; % MHz
Triplet.lwpp = 1; % mT
Triplet.initState = {[0.1 1 0.2],'zerofield'}; % zero-field populations

Exp.mwFreq = 9.5; % GHz
Exp.Range = [310 370]; % mT
Exp.Harmonic = 0; % no field modulation

pepper(Triplet,Exp);
</pre>

<p>
The shape of the EPR spectrum only depends on the <em>polarizations</em> of the transitions, i.e. only on the <em>differences</em> of the populations in <code>Sys.initState</code>. Adding any constant to all three numbers will not affect the shape of the spectrum. It will, however, affect the overall intensity of the simulated spectrum, since EasySpin scales the spectrum to the total population (sum over all numbers in the population vector provided in <code>Sys.initState</code>).

<p>
In case of an axial zero-field splitting interaction (E=0), the degeneracy of two of the zero-field sublevels leads to ambiguity in the assignment of the provided populations and EasySpin returns an error. The simulations can still be performed using the full density matrix in the uncoupled basis as input, which can be determined based on manually defined zero-field state vectors as follows:
<pre class="matlab">
% Get zero-field states and order in terms of energy
[F,~,~,~] = sham(Sys);
[ZFStates,ZFEnergies] = eig(F);
[ZFEnergies,idx] = sort(real(diag(ZFEnergies)));
ZFStates = ZFStates(:,idx);

% Correct zero-field states for S=1 and axial D
if ZFEnergies(2)==ZFEnergies(3)
  % Manual zero-field states (D>0)
  v1 = ZFStates(:,2);
  v2 = ZFStates(:,3);
  ZFStates(:,2) = (v1-v2)/sqrt(2);
  ZFStates(:,3) = (v1+v2)/sqrt(2);
elseif ZFEnergies(2)==ZFEnergies(1)
  % Manual zero-field states (D&lt;0)
  v1 = ZFStates(:,1);
  v2 = ZFStates(:,2);
  ZFStates(:,2) = (v1-v2)/sqrt(2);
  ZFStates(:,1) = (v1+v2)/sqrt(2);
end

% Convert population vector to density matrix
Sys.initState = ZFStates*diag(ZFPops)*ZFStates';
</pre>

<p>
EasySpin can handle ISC-polarized spins of higher multiplicity as well. For example, to simulate spectra from an ISC-generated quartet state, provide 4 numbers in <code>Sys.Pop</code>.

<!-- ----------------------------------------------------------------------------- -->
<div class="subtitle"><a name="recomb">Recombination triplets</a></div>

<p>
To simulate the spin-polarized EPR spectrum of a triplet generated by recombination of two radicals or by singlet fission, which typically results in exclusive population of the T<sub>0</sub> state, you can provide information on the population of the high-field levels in <code>Sys.initState</code> using the basis keyword <code>'eigen'</code>. The populations need to be given in order of increasing energy, i.e. following the usual notation for the high-field states in a triplet, in the order T<sub>-</sub>, T<sub>0</sub>, T<sub>+</sub>. 

<p>
Here is an example for a triplet state generated by recombination of a radical pair.

<pre class="matlab">
clear
Triplet.S = 1;
Triplet.D = [500 -100]; % MHz
Triplet.lwpp = 1;

Triplet.initState = {[0 1 0],'eigen'};

Exp.mwFreq = 9.5;
Exp.Range = [310 370];
Exp.Harmonic = 0; % no field modulation

[B,spc] = pepper(Triplet,Exp);
</pre>


<div class="subtitle"><a name="radpairs">Spin-correlated radical pairs</a></div>

<p>
For the simulation of EPR spectra of spin-correlated radical pairs, the initial density matrix of the system can be specified in <code>Sys.initState</code>. The density matrix needs to be provided in the uncoupled basis described in the documentation for <a href="sop.html">spin operators</a>.

<p>
For a singlet-born radical pair, the populations for the eigenstates i are &lt;i|P<sub>S</sub>|i>, where P<sub>S</sub> is the projection operator onto the electron singlet subspace, i.e. the populations are given by the sum of single-state projection operators |i>&lt;i| over all states that contain an electron spin singlet contribution (&lt;j|S<sup>2</sup>|j> = 0). The electron spin singlet projection operator that needs to be provided as initial density matrix in <code>Sys.initState</code> can be calculated as follows
<pre class="matlab">
spins = [1/2 1/2];
[E,Sx1,Sy1,Sz1,Sx2,Sy2,Sz2] = sop(spins,'ee','x1','y1','z1','x2','y2','z2');

S2 = (Sx1+Sx2)^2+(Sy1+Sy2)^2+(Sz1+Sz2)^2
PS = E - S2/2
</pre>
Alternatively, |S> in the uncoupled basis can also be used to calculate P<sub>S</sub>
<pre class="matlab">
S = 1/sqrt(2)*[0; 1; -1; 0];
PS = S*S'
</pre>

<p>
With this density matrix provided as an input in <code>Sys.initState</code>, EasySpin calculates the population of an eigenstate <code>V</code> of the Hamiltonian based on the provided density matrix <code>Sigma0</code> as <code>PopulationV = V'*Sigma0*V</code>.
</p>

<p>
A singlet-born radical pair can also be specified using the shortcut <code>Sys.initState = 'singlet'</code>.
</p>

<p>
The following is an example for a simulation of a singlet-born spin-correlated radical pair with exchange and dipolar coupling.
</p>

<pre class="matlab">
clear

% Spin system
Sys.S = [1/2 1/2];
Sys.g = [2.0020; 1.9999];

Sys.J = -2; % MHz
Sys.dip = 10; % MHz

Sys.lwpp = 0.05; % mT

% Singlet precursor
Sys.initState = 'singlet';

Exp.Range = [346.5 349.5]; % mT
Exp.mwFreq = 9.75; % GHz
Exp.Harmonic = 0; % no field modulation

[B,spc] = pepper(Sys,Exp);
</pre>

<p>
Alternatively, the initial density matrix can be provided directly:
</p>

<pre class="matlab">
% Set up the initial density matrix for a singlet-born radical pair
S = 1/sqrt(2)*[0;1;-1;0];
Sys.initState = S*S';
</pre>

<p>
For detailed information on how to specify electron-electron spin-spin couplings see the documentation for the <a href="spinsystem.html">spin system definition</a>. Note that different conventions regarding the signs and magnitudes of exchange and dipolar coupling parameters exist in the literature, make sure to convert J and D values correctly when using literature values in EasySpin.
</p>

<p>
EasySpin can also handle spin-polarized systems of higher multiplicity, such as triplet pairs. The dimension of the provided density matrix must match the number of electron states (or the total number of states in a spin system also containing nuclei).
</p>


<!-- ----------------------------------------------------------------------------- -->
<div class="subtitle"><a name="photoselection">Photoselection</a></div>

<p>
Spin-polarized systems are typically generated using photoexcitation with a laser. Excited triplet states are a common example. The triplet yield upon photoexcitation depends on the relative orientation between the E-field vector of the incident laser beam and the electric transition dipole moment vector associated with the optical transition that is being excited at the wavelength of the incident laser beam. If the E-field is parallel to the transition dipole moment, the excitation is maximal, and if the E-field is perpendicular to the transition dipole moment, the excitation is zero. As a consequence, in a powder or frozen-solution sample, not all orientations contribute equally to the EPR spectrum. This phenomenon is called photoselection or magnetophotoselection.
</p>

<p>
To take photoselection into account when simulating an EPR spectrum  with <a class="esf" href="pepper.html">pepper</a>, you need to provide information about the transition dipole moment orientation and about the laser excitation geometry.
</p>

<p>
Use <code>Sys.tdm</code> to provide the orientation of the transition dipole moment in the molecule. For example, for the transition dipole moment along the molecular y axis, use one of the following three equivalent ways:
</p>

<pre class="matlab">
Sys.tdm = 'y';          % letter code
Sys.tdm = [0;1;0];      % unit vector
Sys.tdm = [pi/2 pi/2];  % polar angles phi and theta (in radians)
</pre>

<p>
Use <code>Exp.lightBeam</code> to specify the laser excitation geometry, i.e. the laser propagation direction and the polarization angle (if the laser light is polarized). Several common geometries can be provided via keywords. They all assume a laser beam, polarized or unpolarized, propagating along the laboratory y axis, which is perpendicular to the magnetic field (lab z axis).
</p>

<pre class="matlab">
Exp.lightBeam = 'unpolarized';     % unpolarized beam along lab y
Exp.lightBeam = 'perpendicular';   % polarized beam along lab y with E-field along lab x, perpendicular to B0
Exp.lightBeam = 'parallel';        % polarized beam along lab y with E-field along lab z, parallel to B0
</pre>

<p>
For other geometries, the propagation direction <code>k</code> and the polarization angle <code>alpha</code> can be provided explicitly as <code>Exp.lightBeam = {k alpha}</code>. Refer to the documentation of <a class="esf" href="pepper.html">pepper</a> for details about this.
</p>

<p>
The photoexcitation probabilities are calculated via the function <a class="esf" href="photoselect.html">photoselect</a>. This function returns values between 0 (no excitation) and 1 (maximal excitation), and you can use it directly for exploring the orientation dependence of the photoexcitation yield.
</p>

<p>
Occasionally, when fitting experimental spectra of photo-excited species, it is necessary to include a small contribution with isotropic excitation (i.e. with E-field uniformly distributed in all directions) to account for effects like scattering or energy transfer. The fraction of this contribution, between 0 and 1, is provided in <code>Exp.lightScatter</code>.
</p>

<pre class="matlab">
Exp.lightScatter = 0.2;  % 20% isotropic contribution
</pre>

<p>
Alternatively, you might want to mix <code>'perpendicular'</code> and <code>'parallel'</code>, or <code>'perpendicular'</code> and <code>'unpolarized'</code>. For this, just simulate two separate spectra and add them as desired:
</p>

<pre class="matlab">
Exp.lightBeam = 'perpendicular';
[~,spc_perp] = pepper(Sys,Exp);
Exp.lightBeam = 'parallel';
[B,spc_para] = pepper(Sys,Exp);
w_perp = 0.8;   % weight for perpendicular contribution
spc = w_para*spc_para + (1-w_para)*spc_perp;  % weighted sum
</pre>

<p>
If you don't specify <code>Exp.lightBeam</code>, full isotropic excitation is assumed.
</p>

<p>&nbsp;

<hr>
</section>

<footer></footer>

</body>
</html>
